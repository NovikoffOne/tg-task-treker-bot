# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤ - Todo List Feature

> **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-29  
> **–í–µ—Ä—Å–∏—è:** 1.0

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è OrchestratorAgent](#–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è-–¥–ª—è-orchestratoragent)
3. [–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è TaskManagerAgent](#–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è-–¥–ª—è-taskmanageragent)
4. [–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è DataManagerAgent](#–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è-–¥–ª—è-datamanageragent)
5. [–õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –∑–∞–¥–∞—á](#–ª–æ–≥–∏–∫–∞-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è-—Ç–∏–ø–∞-–∑–∞–¥–∞—á)
6. [–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤](#–ø—Ä–∏–º–µ—Ä—ã-–∑–∞–ø—Ä–æ—Å–æ–≤-–∏-–æ—Ç–≤–µ—Ç–æ–≤)
7. [–§–æ—Ä–º–∞—Ç JSON –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è](#—Ñ–æ—Ä–º–∞—Ç-json-–¥–ª—è-–ø–∞–∫–µ—Ç–Ω–æ–≥–æ-—Å–æ–∑–¥–∞–Ω–∏—è)

---

## üéØ –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ Todo List. –ê–≥–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã —É–º–µ—Ç—å:

1. –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–∞–∫–µ—Ç–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á
2. –ò–∑–≤–ª–µ–∫–∞—Ç—å –¥–∞—Ç—ã –∏ –≤—Ä–µ–º—è –∏–∑ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞
3. –û–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–∏–ø –∑–∞–¥–∞—á (–ª–∏—á–Ω—ã–µ/—Ä–∞–±–æ—á–∏–µ)
4. –°–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è OrchestratorAgent

### –ù–æ–≤—ã–π intent: `add_todo_batch`

–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –≤–∏–¥–∞:
- "–î–æ–±–∞–≤—å –Ω–∞ –∑–∞–≤—Ç—Ä–∞ –∑–∞–¥–∞—á–∏..."
- "–°–æ–∑–¥–∞–π –∑–∞–¥–∞—á–∏ –Ω–∞ 03.12..."
- "–î–æ–±–∞–≤—å –∑–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è..."

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π system prompt

```python
def get_system_prompt(self) -> str:
    return """–¢—ã –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ PMAssist. 

–¢–≤–æ—è –∑–∞–¥–∞—á–∞:
1. –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ò–∑–≤–ª–µ–∫–∞—Ç—å —Å—É—â–Ω–æ—Å—Ç–∏: –ø—Ä–æ–µ–∫—Ç—ã, –∑–∞–¥–∞—á–∏, –¥–µ–π—Å—Ç–≤–∏—è, —Å—Å—ã–ª–∫–∏, –¥–∞—Ç—ã, –≤—Ä–µ–º—è
3. –°–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–∑ –ø–æ–¥–∑–∞–¥–∞—á
4. –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤

–î–æ—Å—Ç—É–ø–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã:
- ATM (Agent Task Manager): —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏/–ø—Ä–æ–µ–∫—Ç–∞–º–∏
- ADM (Agent Data Manager): —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- ACM (Agent Control Manager): –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- AAM (Agent Analyze Manager): –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã

–ù–û–í–´–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ - Todo List:
- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å intent "add_todo_batch" –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á
- –ò–∑–≤–ª–µ–∫–∞—Ç—å –¥–∞—Ç—É –∏–∑ –∑–∞–ø—Ä–æ—Å–∞: "–Ω–∞ –∑–∞–≤—Ç—Ä–∞", "–Ω–∞ 03.12", "–Ω–∞ —Å–µ–≥–æ–¥–Ω—è"
- –†–∞–∑–±–∏–≤–∞—Ç—å –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
- –û–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–∏–ø –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ (–ª–∏—á–Ω–∞—è/—Ä–∞–±–æ—á–∞—è) –ø–æ –Ω–∞–ª–∏—á–∏—é project_id

–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ (JSON):
{
  "intent": "create_project|update_task|query_data|close_task|add_todo_batch|...",
  "entities": {
    "project_id": "...",  // –º–æ–∂–µ—Ç –±—ã—Ç—å "id+" –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ ID
    "project_name": "...",
    "task_id": "...",
    "board_name": "...",
    "date": "2025-11-30",  // –ù–û–í–û–ï: –¥–∞—Ç–∞ –¥–ª—è –∑–∞–¥–∞—á
    "tasks": [  // –ù–û–í–û–ï: —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
      {
        "text": "–í—ã–≥—É–ª –§–µ—Ä—ã –≤ 10:00 –∏ 19:00",
        "date": "2025-11-30",
        "times": ["10:00", "19:00"]
      },
      {
        "text": "5001 - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
        "date": "2025-11-30",
        "project_id": "5001"
      }
    ],
    "actions": ["create", "update", "close", ...],
    "links": [{"type": "–¢–ó|–†–µ—Ñ–µ—Ä–µ–Ω—Å|Figma|...", "url": "..."}]
  },
  "plan": [
    {"agent": "ADM|ATM|ACM|AAM", "action": "...", "params": {...}},
    ...
  ]
}

–í–∞–∂–Ω–æ:
- –ï—Å–ª–∏ project_id = "id+", –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Å–≤–æ–±–æ–¥–Ω—ã–π ID —á–µ—Ä–µ–∑ ADM
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ ADM
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π —á–µ—Ä–µ–∑ ACM
- –ü–ª–∞–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º –∏ –ª–æ–≥–∏—á–Ω—ã–º
- –î–ª—è add_todo_batch –∏—Å–ø–æ–ª—å–∑—É–π ATM.create_todo_batch"""
```

### –ü—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–ø—Ä–æ—Å–∞

**–í—Ö–æ–¥:**
```
–î–æ–±–∞–≤—å –Ω–∞ –∑–∞–≤—Ç—Ä–∞ –∑–∞–¥–∞—á–∏

1. –í—ã–≥—É–ª –§–µ—Ä—ã –≤ 10:00 –∏ 19:00
2. –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ –±–∞—Ä–±–µ—Ä—É 11:00
3. –î–æ–¥–µ–ª–∞—Ç—å –±–æ—Ç–∞ 11:10 - 12:00
4. 5001 - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Å—Ç–æ—Ä–µ
5. 5010 - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Å—Ç–æ—Ä–µ
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```json
{
  "intent": "add_todo_batch",
  "entities": {
    "date": "2025-11-30",
    "tasks": [
      {
        "text": "–í—ã–≥—É–ª –§–µ—Ä—ã",
        "date": "2025-11-30",
        "times": ["10:00", "19:00"],
        "type": "personal"
      },
      {
        "text": "–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ –±–∞—Ä–±–µ—Ä—É",
        "date": "2025-11-30",
        "time": "11:00",
        "type": "personal"
      },
      {
        "text": "–î–æ–¥–µ–ª–∞—Ç—å –±–æ—Ç–∞",
        "date": "2025-11-30",
        "time_start": "11:10",
        "time_end": "12:00",
        "type": "personal"
      },
      {
        "text": "–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Å—Ç–æ—Ä–µ",
        "date": "2025-11-30",
        "project_id": "5001",
        "type": "work"
      },
      {
        "text": "–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Å—Ç–æ—Ä–µ",
        "date": "2025-11-30",
        "project_id": "5010",
        "type": "work"
      }
    ]
  },
  "plan": [
    {
      "agent": "ATM",
      "action": "create_todo_batch",
      "params": {
        "workspace_id": "{workspace_id}",
        "user_id": "{user_id}",
        "tasks": "{entities.tasks}",
        "default_date": "2025-11-30"
      }
    }
  ]
}
```

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è TaskManagerAgent

### –ù–æ–≤—ã–π –º–µ—Ç–æ–¥: create_todo_batch

```python
def create_todo_batch(
    self,
    workspace_id: int,
    user_id: int,
    tasks: List[Dict[str, Any]],
    default_date: Optional[datetime] = None
) -> Dict[str, Any]:
    """
    –°–æ–∑–¥–∞–µ—Ç –ø–∞–∫–µ—Ç –∑–∞–¥–∞—á (–ª–∏—á–Ω—ã–µ + —Ä–∞–±–æ—á–∏–µ)
    
    Args:
        workspace_id: ID –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
        user_id: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        tasks: –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –∏–∑ entities.tasks
        default_date: –î–∞—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    
    Returns:
        {
            "status": "success",
            "message": "...",
            "data": {
                "personal_tasks_created": [...],
                "work_tasks_created": [...],
                "errors": [...]
            }
        }
    """
```

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π system prompt

```python
def get_system_prompt(self) -> str:
    return """–¢—ã Agent Task Manager (ATM) —Å–∏—Å—Ç–µ–º—ã PMAssist.

–¢–≤–æ—è –∑–∞–¥–∞—á–∞:
1. –°–æ–∑–¥–∞–≤–∞—Ç—å –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –∑–∞–¥–∞—á–∏ –∏ –ø—Ä–æ–µ–∫—Ç—ã
2. –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º
3. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
4. –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–µ–¥–ª–∞–π–Ω–∞—Ö

–ù–û–í–´–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ - Todo List:
5. –°–æ–∑–¥–∞–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã –∑–∞–¥–∞—á (–ª–∏—á–Ω—ã–µ + —Ä–∞–±–æ—á–∏–µ)
6. –û–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–∏–ø –∑–∞–¥–∞—á –ø–æ –Ω–∞–ª–∏—á–∏—é project_id
7. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DateParser –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞—Ç –∏ –≤—Ä–µ–º–µ–Ω–∏
8. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TaskClassifier –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –∑–∞–¥–∞—á–∏

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î –≤—ã–ø–æ–ª–Ω—è–π —á–µ—Ä–µ–∑ ADM (Agent Data Manager).

–ü—Ä–∞–≤–∏–ª–∞:
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–æ—Å–∫–∏:
  Backend, Design, Dev, Test, Accountant, ASO
- –ü—Ä–æ–≤–µ—Ä—è–π, —á—Ç–æ —É –∑–∞–¥–∞—á–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–æ–ª–∏
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –∑–∞–¥–∞—á–∏ –Ω–∞ –¥–æ—Å–∫–µ "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞" —Å–æ–∑–¥–∞–≤–∞–π –∑–∞–¥–∞—á—É –Ω–∞ –¥–æ—Å–∫–µ "–î–∏–∑–∞–π–Ω"

–ù–û–í–´–ï –ü–†–ê–í–ò–õ–ê –¥–ª—è Todo List:
- –õ–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–±–µ–∑ project_id) ‚Üí —Å–æ–∑–¥–∞–≤–∞—Ç—å —á–µ—Ä–µ–∑ ADM.create_personal_task
- –†–∞–±–æ—á–∏–µ –∑–∞–¥–∞—á–∏ (—Å project_id) ‚Üí —Å–æ–∑–¥–∞–≤–∞—Ç—å —á–µ—Ä–µ–∑ ADM.create_task —Å project_id –∏ scheduled_date
- –ï—Å–ª–∏ –≤ –∑–∞–¥–∞—á–µ —É–∫–∞–∑–∞–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω ("10:00 –∏ 19:00") ‚Üí —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏
- –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω –¥–∏–∞–ø–∞–∑–æ–Ω –≤—Ä–µ–º–µ–Ω–∏ ("11:10 - 12:00") ‚Üí —Å–æ—Ö—Ä–∞–Ω—è—Ç—å time_start –∏ time_end

–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ (JSON):
{
  "status": "success|error",
  "message": "...",
  "data": {
    "personal_tasks_created": [{"id": 1, "title": "..."}],
    "work_tasks_created": [{"id": 2, "title": "...", "project_id": "5001"}],
    "errors": []
  }
}"""
```

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è DataManagerAgent

### –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å personal_tasks

```python
def create_personal_task(
    self,
    user_id: int,
    title: str,
    scheduled_date: date,
    scheduled_time: Optional[time] = None,
    scheduled_time_end: Optional[time] = None,
    deadline: Optional[datetime] = None,
    description: Optional[str] = None
) -> Dict[str, Any]:
    """
    –°–æ–∑–¥–∞—Ç—å –ª–∏—á–Ω—É—é –∑–∞–¥–∞—á—É
    
    Returns:
        {
            "status": "success",
            "message": "–õ–∏—á–Ω–∞—è –∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞",
            "data": {"id": 1, "title": "..."}
        }
    """

def get_personal_tasks_by_date(
    self,
    user_id: int,
    target_date: date
) -> Dict[str, Any]:
    """
    –ü–æ–ª—É—á–∏—Ç—å –ª–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É
    
    Returns:
        {
            "status": "success",
            "data": [PersonalTask, ...]
        }
    """

def mark_personal_task_completed(
    self,
    task_id: int,
    user_id: int
) -> Dict[str, Any]:
    """
    –û—Ç–º–µ—Ç–∏—Ç—å –ª–∏—á–Ω—É—é –∑–∞–¥–∞—á—É –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é
    
    Returns:
        {
            "status": "success",
            "message": "–ó–∞–¥–∞—á–∞ –æ—Ç–º–µ—á–µ–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è"
        }
    """
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ create_task

–ú–µ—Ç–æ–¥ `create_task` –¥–æ–ª–∂–µ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è:
- `scheduled_date: Optional[date]`
- `scheduled_time: Optional[time]`
- `scheduled_time_end: Optional[time]`

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π system prompt

```python
def get_system_prompt(self) -> str:
    return """–¢—ã Agent Data Manager (ADM) —Å–∏—Å—Ç–µ–º—ã PMAssist.

–¢–≤–æ—è –∑–∞–¥–∞—á–∞:
1. –í—ã–ø–æ–ª–Ω—è—Ç—å –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
2. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é
3. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ë–î
4. –í–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ù–û–í–´–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ - Todo List:
5. –†–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∞–±–ª–∏—Ü–µ–π personal_tasks –¥–ª—è –ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á
6. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø–æ–ª—è scheduled_date, scheduled_time, scheduled_time_end –≤ tasks
7. –°–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ —Å –¥–∞—Ç–∞–º–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
- create_project, get_project, update_project
- create_task, get_task, update_task, delete_task
- create_personal_task, get_personal_tasks_by_date, mark_personal_task_completed  // –ù–û–í–û–ï
- create_board, get_board
- create_column, get_column
- –ò –¥—Ä—É–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î

–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ (JSON):
{
  "status": "success|error",
  "message": "...",
  "data": {...}
}

–í–∞–∂–Ω–æ:
- –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π (project_id, column_id)
- –í–∞–ª–∏–¥–∏—Ä—É–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é
- –í–æ–∑–≤—Ä–∞—â–∞–π –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö"""
```

---

## üéØ –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –∑–∞–¥–∞—á

### –ê–ª–≥–æ—Ä–∏—Ç–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

```python
def classify_task(task_text: str, workspace_id: int) -> Dict[str, Any]:
    """
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –∑–∞–¥–∞—á–∏ –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç project_id –µ—Å–ª–∏ –µ—Å—Ç—å
    
    –ê–ª–≥–æ—Ä–∏—Ç–º:
    1. –ò—â–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω project_id –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏:
       - "5001 - —Ç–µ–∫—Å—Ç"
       - "5001 —Ç–µ–∫—Å—Ç"
       - "5001: —Ç–µ–∫—Å—Ç"
       - "5001 —Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏"
    
    2. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω –ø–∞—Ç—Ç–µ—Ä–Ω:
       - –ò–∑–≤–ª–µ–∫–∞–µ–º project_id (—á–∏—Å–ª–æ –∏–∑ 4-5 —Ü–∏—Ñ—Ä)
       - –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ —á–µ—Ä–µ–∑ ADM.get_project
       - –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí type = "work"
       - –ò–Ω–∞—á–µ ‚Üí type = "personal" (–ø—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω)
    
    3. –ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω:
       - type = "personal"
    
    4. –û—á–∏—â–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Ç project_id –∏ –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
    
    Returns:
        {
            "type": "personal" | "work",
            "project_id": str | None,
            "title": str,  # –û—á–∏—â–µ–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
            "description": str | None
        }
    """
```

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è project_id

```python
PROJECT_ID_PATTERNS = [
    r'^(\d{4,5})\s*[-‚Äì:]\s*(.+)',  # "5001 - —Ç–µ–∫—Å—Ç" –∏–ª–∏ "5001: —Ç–µ–∫—Å—Ç"
    r'^(\d{4,5})\s+(.+)',  # "5001 —Ç–µ–∫—Å—Ç"
    r'(\d{4,5})\s*[-‚Äì:]\s*(.+)',  # –í —Å–µ—Ä–µ–¥–∏–Ω–µ —Å—Ç—Ä–æ–∫–∏
]
```

### –ü—Ä–∏–º–µ—Ä—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

| –í—Ö–æ–¥ | –¢–∏–ø | project_id | –û—á–∏—â–µ–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ |
|------|-----|------------|---------------------|
| "–í—ã–≥—É–ª –§–µ—Ä—ã" | personal | None | "–í—ã–≥—É–ª –§–µ—Ä—ã" |
| "5001 - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å" | work | "5001" | "–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å" |
| "5001 –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å" | work | "5001" | "–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å" |
| "5010: –ó–∞–ø—É—Å—Ç–∏—Ç—å" | work | "5010" | "–ó–∞–ø—É—Å—Ç–∏—Ç—å" |
| "–ó–∞–¥–∞—á–∞ –¥–ª—è 5001" | personal | None | "–ó–∞–¥–∞—á–∞ –¥–ª—è 5001" |

---

## üí¨ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤

### –ü—Ä–∏–º–µ—Ä 1: –ü–∞–∫–µ—Ç–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∑–∞–≤—Ç—Ä–∞

**–ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```
–î–æ–±–∞–≤—å –Ω–∞ –∑–∞–≤—Ç—Ä–∞ –∑–∞–¥–∞—á–∏

1. –í—ã–≥—É–ª –§–µ—Ä—ã –≤ 10:00 –∏ 19:00
2. –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ –±–∞—Ä–±–µ—Ä—É 11:00
3. 5001 - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

**–û—Ç–≤–µ—Ç OrchestratorAgent:**
```json
{
  "intent": "add_todo_batch",
  "entities": {
    "date": "2025-11-30",
    "tasks": [
      {
        "text": "–í—ã–≥—É–ª –§–µ—Ä—ã",
        "date": "2025-11-30",
        "times": ["10:00", "19:00"],
        "type": "personal"
      },
      {
        "text": "–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ –±–∞—Ä–±–µ—Ä—É",
        "date": "2025-11-30",
        "time": "11:00",
        "type": "personal"
      },
      {
        "text": "–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
        "date": "2025-11-30",
        "project_id": "5001",
        "type": "work"
      }
    ]
  },
  "plan": [
    {
      "agent": "ATM",
      "action": "create_todo_batch",
      "params": {
        "workspace_id": 1,
        "user_id": 123456,
        "tasks": "{entities.tasks}",
        "default_date": "2025-11-30"
      }
    }
  ]
}
```

**–û—Ç–≤–µ—Ç TaskManagerAgent:**
```json
{
  "status": "success",
  "message": "–°–æ–∑–¥–∞–Ω–æ 3 –∑–∞–¥–∞—á–∏: 2 –ª–∏—á–Ω—ã–µ, 1 —Ä–∞–±–æ—á–∞—è",
  "data": {
    "personal_tasks_created": [
      {"id": 1, "title": "–í—ã–≥—É–ª –§–µ—Ä—ã", "time": "10:00"},
      {"id": 2, "title": "–í—ã–≥—É–ª –§–µ—Ä—ã", "time": "19:00"},
      {"id": 3, "title": "–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ –±–∞—Ä–±–µ—Ä—É", "time": "11:00"}
    ],
    "work_tasks_created": [
      {"id": 100, "title": "–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ", "project_id": "5001"}
    ],
    "errors": []
  }
}
```

### –ü—Ä–∏–º–µ—Ä 2: –ó–∞–¥–∞—á–∞ —Å –¥–∞—Ç–æ–π –≤ –±—É–¥—É—â–µ–º

**–ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```
–î–æ–±–∞–≤—å –∑–∞–¥–∞—á—É: 5007 - –ü—Ä–æ–º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫—É 03.12
```

**–û—Ç–≤–µ—Ç OrchestratorAgent:**
```json
{
  "intent": "add_todo_batch",
  "entities": {
    "date": "2025-12-03",
    "tasks": [
      {
        "text": "–ü—Ä–æ–º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫—É",
        "date": "2025-12-03",
        "project_id": "5007",
        "type": "work"
      }
    ]
  },
  "plan": [
    {
      "agent": "ATM",
      "action": "create_todo_batch",
      "params": {
        "workspace_id": 1,
        "user_id": 123456,
        "tasks": "{entities.tasks}",
        "default_date": "2025-12-03"
      }
    }
  ]
}
```

---

## üìã –§–æ—Ä–º–∞—Ç JSON –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ tasks –≤ entities

```json
{
  "tasks": [
    {
      "text": "–¢–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏",
      "date": "2025-11-30",  // ISO —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã
      "time": "10:00",  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —Ñ–æ—Ä–º–∞—Ç HH:MM
      "time_start": "11:10",  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞
      "time_end": "12:00",  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞
      "times": ["10:00", "19:00"],  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è
      "type": "personal" | "work",
      "project_id": "5001",  // –¢–æ–ª—å–∫–æ –¥–ª—è work –∑–∞–¥–∞—á
      "description": "–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏"  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    }
  ]
}
```

### –ü—Ä–∞–≤–∏–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

1. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è:**
   - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ `times` ‚Üí —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
   - –ü—Ä–∏–º–µ—Ä: `"times": ["10:00", "19:00"]` ‚Üí 2 –∑–∞–¥–∞—á–∏

2. **–î–∏–∞–ø–∞–∑–æ–Ω –≤—Ä–µ–º–µ–Ω–∏:**
   - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã `time_start` –∏ `time_end` ‚Üí –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º
   - –ü—Ä–∏–º–µ—Ä: `"time_start": "11:10", "time_end": "12:00"` ‚Üí 1 –∑–∞–¥–∞—á–∞

3. **–û–¥–Ω–æ –≤—Ä–µ–º—è:**
   - –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ —Ç–æ–ª—å–∫–æ `time` ‚Üí –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ —Å –≤—Ä–µ–º–µ–Ω–µ–º
   - –ü—Ä–∏–º–µ—Ä: `"time": "10:00"` ‚Üí 1 –∑–∞–¥–∞—á–∞

4. **–ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏:**
   - –ï—Å–ª–∏ –≤—Ä–µ–º—è –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Üí –∑–∞–¥–∞—á–∞ –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
   - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –æ–±—â–µ–º —Å–ø–∏—Å–∫–µ –±–µ–∑ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è](../specifications/todo-list-feature.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–∞—Ä—Å–∏–Ω–≥—É –¥–∞—Ç](date-parsing-guide.md)
- [–¢–µ—Å—Ç-–ø–ª–∞–Ω](../testing/todo-list-test-plan.md)

---

**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-01-29

