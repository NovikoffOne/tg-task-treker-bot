# Возможности Telegram Task Tracker Bot

> **Дата создания:** 2025-01-28  
> **Версия:** 2.0

## Полный список команд

### Базовые команды

| Команда | Описание | Пример |
|---------|----------|--------|
| `/start` | Начать работу с ботом | `/start` |
| `/help` | Показать справку по командам | `/help` |
| `/menu` | Показать главное меню | `/menu` |
| `/ai <запрос>` | AI-помощник для работы с задачами | `/ai создать проект 5001 Test` |

### Пространства (Workspaces)

| Команда | Описание | Пример |
|---------|----------|--------|
| `/workspaces` | Список всех пространств | `/workspaces` |
| `/newworkspace <название>` | Создать пространство | `/newworkspace Работа` |
| `/delworkspace <название>` | Удалить пространство | `/delworkspace Работа` |
| `/renameworkspace <старое> <новое>` | Переименовать пространство | `/renameworkspace Работа Работа 2025` |

**Особенности:**
- Названия пространств уникальны для каждого пользователя
- При удалении пространства удаляются все доски, проекты и задачи
- Минимальная длина названия: 2 символа

### Доски (Boards)

| Команда | Описание | Пример |
|---------|----------|--------|
| `/boards` | Список всех досок текущего пространства | `/boards` |
| `/newboard <название>` | Создать доску с дефолтными колонками | `/newboard Дизайн` |
| `/delboard <название>` | Удалить доску | `/delboard Дизайн` |
| `/board <название>` | Показать доску (Kanban-визуализация) | `/board Дизайн` |
| `/boardlist <название>` | Показать доску в виде списка | `/boardlist Дизайн` |

**Особенности:**
- При создании доски автоматически создаются колонки: "Очередь", "В работе", "Готово"
- Доски уникальны в рамках пространства
- При удалении доски удаляются все колонки и задачи

### Колонки (Columns)

| Команда | Описание | Пример |
|---------|----------|--------|
| `/columns <доска>` | Список колонок доски | `/columns Дизайн` |
| `/addcolumn <доска> <название>` | Добавить колонку | `/addcolumn Дизайн План на неделю` |
| `/delcolumn <доска> <колонка>` | Удалить колонку | `/delcolumn Дизайн План на неделю` |

**Особенности:**
- Колонки уникальны в рамках доски
- При удалении колонки задачи перемещаются в первую колонку или удаляются
- Порядок колонок сохраняется

### Проекты (Projects)

| Команда | Описание | Пример |
|---------|----------|--------|
| `/projects` | Список всех проектов | `/projects` |
| `/newproject <id> <название>` | Создать проект | `/newproject 5001 Pictory Ai` |
| `/project <id>` | Показать проект с дашбордом | `/project 5001` |
| `/projectdashboard <id>` | Показать дашборд проекта | `/projectdashboard 5001` |
| `/delproject <id>` | Удалить проект | `/delproject 5001` |

**Особенности:**
- При создании проекта автоматически создаются задачи на всех досках пространства
- Формат названия задачи: "{project_id} {project_name} {board_name}"
- ID проекта уникален в рамках пространства
- При удалении проекта задачи остаются, но теряют связь с проектом

**Автоматическое создание задач:**
- При создании проекта "5001 Pictory Ai" в пространстве с досками "Дизайн" и "Разработка":
  - Создается задача "5001 Pictory Ai Дизайн" на доске "Дизайн"
  - Создается задача "5001 Pictory Ai Разработка" на доске "Разработка"
  - Все задачи помещаются в первую колонку (Очередь)

**Дашборд проекта:**
- Автоматическое определение текущего этапа на основе колонок задач
- Отображение прогресса по этапам
- Список всех задач проекта с их статусами

### Задачи (Tasks)

| Команда | Описание | Пример |
|---------|----------|--------|
| `/newtask` | Создать задачу (интерактивный режим) | `/newtask` |
| `/task <id>` | Показать задачу | `/task 123` |
| `/movetask <id> <колонка>` | Переместить задачу | `/movetask 123 В работе` |
| `/priority <id> <0-3>` | Установить приоритет | `/priority 123 2` |
| `/deltask <id>` | Удалить задачу | `/deltask 123` |
| `/mytasks` | Мои задачи (где я назначен) | `/mytasks` |
| `/today` | Задачи с дедлайном на сегодня | `/today` |
| `/deadline <id> <дата>` | Установить дедлайн | `/deadline 123 2025-02-01` |

**Особенности:**
- При создании задачи через `/newtask` используется интерактивный режим:
  1. Выбор доски
  2. Выбор колонки
  3. Ввод названия
  4. Ввод описания (опционально)
- При перемещении задачи в колонку "В работе" автоматически устанавливается `started_at`
- При перемещении задачи в колонку "Готово" автоматически устанавливается `completed_at`
- Приоритеты: 0=низкий, 1=средний, 2=высокий, 3=критический

**Автоматическое треканье дат:**
- `started_at` - устанавливается при перемещении в "В работе"
- `completed_at` - устанавливается при перемещении в "Готово"
- `deadline` - устанавливается вручную через команду `/deadline`

### Метки (Tags)

| Команда | Описание | Пример |
|---------|----------|--------|
| `/newtag <название> [цвет]` | Создать метку | `/newtag дизайн #FF5733` |
| `/addtag <task_id> <tag>` | Добавить метку к задаче | `/addtag 123 дизайн` |
| `/deltag <task_id> <tag>` | Удалить метку | `/deltag 123 дизайн` |

**Особенности:**
- Метки создаются на уровне пространства
- Метки доступны для всех задач пространства
- Цвет указывается в формате HEX (по умолчанию #3498db)
- Метки можно использовать для фильтрации задач

### Динамические поля (Custom Fields)

| Команда | Описание | Пример |
|---------|----------|--------|
| `/newfield <название> <тип>` | Создать поле | `/newfield Figma url` |
| `/addfield <id> <поле> <значение>` | Добавить поле к задаче | `/addfield 123 Figma https://figma.com/...` |

**Типы полей:**
- `text` - Текст (любая строка)
- `url` - Ссылка (с валидацией формата URL)
- `number` - Число (целое или дробное)
- `date` - Дата (формат: YYYY-MM-DD)
- `select` - Выбор из списка (значения через запятую)

**Особенности:**
- Поля создаются на уровне пространства
- При добавлении поля к задаче проекта поле автоматически синхронизируется со всеми задачами проекта
- При изменении поля обновляются все задачи проекта
- Валидация значений по типу поля (особенно для URL)

**Синхронизация полей:**
- Автоматическая синхронизация для задач проекта
- При добавлении поля к задаче проекта:
  1. Поле добавляется к текущей задаче
  2. Поле автоматически добавляется ко всем задачам проекта
  3. Значение синхронизируется между всеми задачами

### Статистика

| Команда | Описание | Пример |
|---------|----------|--------|
| `/stats` | Общая статистика пространства | `/stats` |
| `/statsproject <id>` | Статистика проекта | `/statsproject 5001` |
| `/statsboard <название>` | Статистика доски | `/statsboard Дизайн` |

**Статистика включает:**
- Количество пространств, досок, задач
- Распределение задач по статусам (выполнено, в работе, в очереди)
- Прогресс проектов
- Распределение задач по приоритетам и меткам

### Зависимости досок (Board Dependencies)

| Команда | Описание | Пример |
|---------|----------|--------|
| `/dependencies` | Список зависимостей | `/dependencies` |
| `/newdependency <параметры>` | Создать зависимость | `/newdependency "Подготовка->Дизайн" Подготовка Готово Дизайн Очередь create_task` |
| `/deldependency <id>` | Удалить зависимость | `/deldependency 1` |

**Формат создания зависимости:**
```
/newdependency <название> <исходная_доска> <исходная_колонка> <целевая_доска> <целевая_колонка> <действие> [шаблон]
```

**Типы действий:**
- `create_task` - создать задачу на целевой доске при перемещении в исходную колонку
- `move_task` - переместить задачу на целевую доску при перемещении в исходную колонку

**Особенности:**
- Зависимости работают автоматически при перемещении задач
- Можно указать шаблон названия задачи для `create_task`
- Зависимости можно включать/отключать

**Примеры:**
- При перемещении задачи проекта в колонку "Готово" доски "Подготовка" → автоматически создать задачу на доске "Дизайн" в колонке "Очередь"
- При перемещении задачи в колонку "Готово" доски "Разработка" → автоматически переместить задачу на доску "Тестирование" в колонку "Очередь"

### Тестирование

| Команда | Описание | Пример |
|---------|----------|--------|
| `/start_test_basecase` | Запустить базовый тест | `/start_test_basecase` |
| `@start_test_basecase` | Запустить тест через тег | `@start_test_basecase` |

**Особенности:**
- Автоматический тест полного цикла работы с проектом
- Проверка создания структуры, работы с задачами, синхронизации полей
- Результаты теста отправляются в чат

## Ограничения и особенности

### Ограничения

1. **Названия:**
   - Минимум 2 символа
   - Максимум 100 символов
   - Уникальность в рамках родительской сущности

2. **Описания:**
   - Максимум 2000 символов

3. **ID проектов:**
   - Уникальность в рамках пространства
   - Может быть любой строкой

4. **URL полей:**
   - Валидация формата URL
   - Должен начинаться с `http://` или `https://`

### Особенности работы

1. **Автоматическое создание задач проекта:**
   - Задачи создаются на всех досках пространства
   - Формат названия: "{project_id} {project_name} {board_name}"
   - Все задачи помещаются в первую колонку

2. **Синхронизация полей:**
   - Автоматическая для задач проекта
   - При изменении поля обновляются все задачи проекта
   - Можно управлять через таблицу `project_field_sync`

3. **Автоматическое треканье дат:**
   - `started_at` - при перемещении в "В работе"
   - `completed_at` - при перемещении в "Готово"
   - `deadline` - устанавливается вручную

4. **Назначение задач:**
   - При перемещении в "В работе" пользователь автоматически добавляется как участник проекта
   - Роль определяется на основе доски

5. **Зависимости досок:**
   - Работают автоматически при перемещении задач
   - Можно создавать сложные цепочки зависимостей

## Примеры использования

### Пример 1: Создание проекта

```
1. /newworkspace Работа
2. /newboard Дизайн
3. /newboard Разработка
4. /newproject 5001 Pictory Ai
5. /project 5001
```

**Результат:**
- Создан проект "5001 Pictory Ai"
- Автоматически созданы задачи:
  - "5001 Pictory Ai Дизайн" на доске "Дизайн"
  - "5001 Pictory Ai Разработка" на доске "Разработка"

### Пример 2: Добавление ссылки к проекту

```
1. /newfield Figma url
2. /addfield 1 Figma https://figma.com/file/123
```

**Результат:**
- Создано поле "Figma" типа "url"
- Ссылка добавлена к задаче #1
- Если задача принадлежит проекту, ссылка синхронизирована со всеми задачами проекта

### Пример 3: Перемещение задачи

```
1. /task 1
2. /movetask 1 В работе
3. /board Дизайн
```

**Результат:**
- Задача #1 перемещена в колонку "В работе"
- Автоматически установлена дата `started_at`
- Если задача проекта, обновлен дашборд проекта

### Пример 4: Создание зависимости

```
/newdependency "Подготовка->Дизайн" Подготовка Готово Дизайн Очередь create_task "{project_id} {project_name} Дизайн"
```

**Результат:**
- При перемещении задачи проекта в колонку "Готово" доски "Подготовка"
- Автоматически создается задача на доске "Дизайн" в колонке "Очередь"
- Название задачи формируется по шаблону

## Технические детали

### База данных

- SQLite база данных
- Путь по умолчанию: `data/tasks.db`
- Автоматическая миграция при запуске

### Структура данных

- Иерархия: User → Workspace → Board → Column → Task
- Проекты связаны с задачами через `project_id`
- Поля и метки создаются на уровне пространства

### Производительность

- Индексы на часто запрашиваемых полях
- Оптимизированные запросы для синхронизации полей
- Транзакции для операций изменения нескольких таблиц

