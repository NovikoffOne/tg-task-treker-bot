# Примеры использования Telegram MCP для тестирования

## Что такое Telegram MCP?

Telegram MCP (Model Context Protocol) - это сервер, который позволяет Cursor AI взаимодействовать с вашим Telegram аккаунтом напрямую. Это позволяет тестировать бота автоматически без ручного ввода команд.

## Доступные функции MCP

### Поиск и получение чатов
- `mcp_telegram-mcp_list_chats` - список всех чатов
- `mcp_telegram-mcp_get_chat` - информация о конкретном чате
- `mcp_telegram-mcp_get_direct_chat_by_contact` - найти чат по username
- `mcp_telegram-mcp_search_contacts` - поиск контактов

### Отправка сообщений
- `mcp_telegram-mcp_send_message` - отправить текстовое сообщение
- `mcp_telegram-mcp_send_file` - отправить файл

### Получение сообщений
- `mcp_telegram-mcp_get_messages` - получить сообщения из чата
- `mcp_telegram-mcp_list_messages` - список сообщений с фильтрами
- `mcp_telegram-mcp_get_message_context` - контекст вокруг сообщения

## Примеры использования через Cursor AI

### Пример 1: Простой тест команды /start

**Запрос к Cursor AI:**
```
Найди чат с ботом my_task_tracker_bot через Telegram MCP, отправь ему команду /start, 
подожди 2 секунды и покажи ответ бота.
```

**Что произойдет:**
1. Cursor найдет чат с ботом через `mcp_telegram-mcp_get_direct_chat_by_contact`
2. Отправит `/start` через `mcp_telegram-mcp_send_message`
3. Подождет 2 секунды
4. Получит ответ через `mcp_telegram-mcp_get_messages`
5. Покажет результат

### Пример 2: Тест создания пространства

**Запрос к Cursor AI:**
```
Отправь команду /newworkspace Тестовое пространство боту my_task_tracker_bot через Telegram MCP 
и покажи ответ. Проверь, что пространство было создано успешно.
```

### Пример 3: Комплексный тест

**Запрос к Cursor AI:**
```
Протестируй бота my_task_tracker_bot через Telegram MCP:
1. Отправь /start и проверь, что бот ответил приветствием
2. Отправь /newworkspace Тест и проверь успешное создание
3. Отправь /workspaces и проверь, что "Тест" есть в списке
4. Отправь /newboard Тестовая доска и проверь успешное создание
5. Отправь /boards и проверь наличие "Тестовая доска"

Покажи результаты каждого шага и общий итог тестирования.
```

### Пример 4: Тест с проверкой ответа

**Запрос к Cursor AI:**
```
Отправь команду /help боту my_task_tracker_bot через Telegram MCP. 
Проверь, что в ответе есть слова "команды" или "справка". 
Если есть - скажи что тест пройден, если нет - покажи ответ бота.
```

### Пример 5: Тест интерактивной команды

**Запрос к Cursor AI:**
```
Отправь команду /newtask боту my_task_tracker_bot через Telegram MCP. 
Подожди ответа. Если бот спрашивает о доске, отправь название существующей доски. 
Продолжай диалог до завершения создания задачи или отмены.
```

## Структура тестового запроса

### Базовый формат:
```
[Действие] боту [username] через Telegram MCP [дополнительные инструкции]
```

### Расширенный формат:
```
Протестируй бота [username] через Telegram MCP:
1. [Команда 1] - [ожидаемый результат]
2. [Команда 2] - [ожидаемый результат]
3. [Команда 3] - [ожидаемый результат]

Покажи результаты каждого шага.
```

## Практические сценарии

### Сценарий 1: Проверка базовой функциональности

```
Протестируй базовые команды бота my_task_tracker_bot:
- /start (должен показать меню)
- /help (должен показать справку)
- /menu (должен показать меню)

Покажи ответы бота для каждой команды.
```

### Сценарий 2: Тест CRUD операций

```
Протестируй CRUD операции бота my_task_tracker_bot:
1. Создай пространство "Тест" через /newworkspace
2. Проверь список через /workspaces
3. Создай доску "Тестовая" через /newboard
4. Проверь список через /boards
5. Создай проект "1001 Тест" через /newproject
6. Проверь список через /projects

Покажи результаты каждого шага.
```

### Сценарий 3: Тест обработки ошибок

```
Протестируй обработку ошибок бота my_task_tracker_bot:
1. Отправь /delworkspace Несуществующее (должна быть ошибка)
2. Отправь /delboard Несуществующая (должна быть ошибка)
3. Отправь /task 99999 (должна быть ошибка)

Покажи ответы бота и проверь, что ошибки обрабатываются корректно.
```

### Сценарий 4: Тест интерактивных команд

```
Протестируй интерактивное создание задачи:
1. Отправь /newtask
2. Когда бот спросит доску, отправь название существующей доски
3. Когда бот спросит колонку, отправь название колонки
4. Когда бот спросит название, отправь "Тестовая задача"
5. Когда бот спросит описание, отправь "Описание тестовой задачи"

Покажи весь диалог и проверь, что задача создана успешно.
```

## Советы по тестированию

### 1. Всегда указывайте username бота
```
✅ Правильно: "боту my_task_tracker_bot"
❌ Неправильно: "боту" или "бот"
```

### 2. Добавляйте задержки для интерактивных команд
```
✅ Правильно: "отправь команду, подожди 2 секунды, получи ответ"
❌ Неправильно: "отправь команду и сразу получи ответ"
```

### 3. Проверяйте результаты
```
✅ Правильно: "проверь, что в ответе есть слово 'успешно'"
❌ Неправильно: "отправь команду" (без проверки)
```

### 4. Используйте конкретные ожидания
```
✅ Правильно: "проверь, что пространство 'Тест' есть в списке"
❌ Неправильно: "проверь список" (без конкретики)
```

## Отладка через MCP

### Проблема: Чат не найден

**Решение:**
```
Найди все чаты через Telegram MCP и покажи список. 
Затем найди бота my_task_tracker_bot через search_contacts.
```

### Проблема: Бот не отвечает

**Решение:**
```
Получи последние 10 сообщений из чата с ботом my_task_tracker_bot 
и покажи их. Проверь, есть ли там мои сообщения и ответы бота.
```

### Проблема: Неправильный ответ

**Решение:**
```
Отправь команду /start боту my_task_tracker_bot и покажи полный ответ. 
Также покажи контекст последних 5 сообщений в этом чате.
```

## Автоматизация тестов

Вы можете создать файл с тестовыми сценариями и попросить Cursor AI выполнить их все:

```
Выполни все тесты из файла test_scenarios.txt для бота my_task_tracker_bot через Telegram MCP.
Покажи результаты каждого теста и общий отчет.
```

## Полезные команды для отладки

### Посмотреть все чаты
```
Покажи список всех чатов через Telegram MCP
```

### Найти конкретный чат
```
Найди чат с ботом my_task_tracker_bot через Telegram MCP и покажи его информацию
```

### Посмотреть историю сообщений
```
Покажи последние 20 сообщений из чата с ботом my_task_tracker_bot
```

### Проверить статус бота
```
Отправь /start боту my_task_tracker_bot. Если бот не отвечает в течение 5 секунд, 
скажи что бот не работает.
```

## Заключение

Telegram MCP позволяет полностью автоматизировать тестирование бота через Cursor AI. Просто описывайте, что нужно протестировать, и Cursor AI выполнит все необходимые действия автоматически.

Для начала используйте простые команды, а затем переходите к более сложным сценариям.

