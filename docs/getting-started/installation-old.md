# Инструкция по настройке проекта

## Предварительные требования

- Python 3.10 или выше
- pip (менеджер пакетов Python)
- Telegram аккаунт
- Токен бота от @BotFather

## Шаг 1: Получение токена бота

1. Откройте Telegram и найдите [@BotFather](https://t.me/BotFather)
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания бота:
   - Введите имя бота (например: "My Task Tracker")
   - Введите username бота (должен заканчиваться на `bot`, например: `my_task_tracker_bot`)
4. Скопируйте полученный токен (выглядит как `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

## Шаг 2: Установка зависимостей

```bash
# Создайте виртуальное окружение (рекомендуется)
python -m venv venv

# Активируйте виртуальное окружение
# На Windows:
venv\Scripts\activate
# На macOS/Linux:
source venv/bin/activate

# Установите зависимости
pip install -r requirements.txt
```

## Шаг 3: Настройка конфигурации

1. Скопируйте файл `.env.example` в `.env`:
   ```bash
   cp .env.example .env
   ```

2. Откройте `.env` и вставьте ваш токен бота:
   ```env
   BOT_TOKEN=ваш_токен_здесь
   ```

3. При необходимости измените другие настройки:
   ```env
   DATABASE_PATH=data/tasks.db
   TASKS_PER_PAGE=5
   TIMEZONE=Europe/Moscow
   ```

## Шаг 4: Создание структуры папок

```bash
# Создайте необходимые директории
mkdir -p handlers utils data
touch handlers/__init__.py utils/__init__.py
touch data/.gitkeep
```

## Шаг 5: Запуск бота

```bash
python bot.py
```

Если все настроено правильно, вы увидите сообщение:
```
Бот запущен и готов к работе!
```

## Шаг 6: Проверка работы

1. Откройте Telegram
2. Найдите вашего бота по username (который вы указали при создании)
3. Отправьте команду `/start`
4. Бот должен ответить приветственным сообщением и показать меню

## Решение проблем

### Ошибка: "Token is invalid"
- Проверьте, что токен в `.env` скопирован правильно
- Убедитесь, что нет лишних пробелов
- Убедитесь, что токен не истек (создайте новый бот если нужно)

### Ошибка: "Module not found"
- Убедитесь, что виртуальное окружение активировано
- Выполните `pip install -r requirements.txt` еще раз
- Проверьте, что все файлы созданы (handlers/__init__.py, utils/__init__.py)

### Ошибка: "Permission denied" при создании БД
- Проверьте права на запись в папку `data/`
- Создайте папку вручную: `mkdir -p data`
- Проверьте права доступа к папке проекта

### Ошибка: "Database is locked"
- Убедитесь, что бот не запущен в другом процессе
- Закройте все другие экземпляры бота
- Перезапустите бота

### Бот не отвечает на команды
- Проверьте логи на наличие ошибок
- Убедитесь, что handlers правильно зарегистрированы
- Проверьте, что ConversationHandler правильно настроен

## Дополнительная настройка

### Изменение пути к базе данных

В файле `.env` можно указать другой путь:
```env
DATABASE_PATH=/path/to/your/database.db
```

### Изменение количества задач на странице

В файле `.env`:
```env
TASKS_PER_PAGE=10
```

### Логирование

По умолчанию логи выводятся в консоль. Для сохранения в файл можно добавить настройку в `bot.py`:

```python
import logging

file_handler = logging.FileHandler('bot.log')
file_handler.setLevel(logging.INFO)
logger.addHandler(file_handler)
```

## Запуск в фоновом режиме (Linux/Mac)

Для запуска бота в фоне можно использовать `nohup`:

```bash
nohup python bot.py > bot.log 2>&1 &
```

Или использовать systemd для автозапуска (для продакшена).

## Обновление бота

1. Остановите текущий процесс бота
2. Обновите код (git pull или замените файлы)
3. Установите новые зависимости (если есть): `pip install -r requirements.txt`
4. Запустите бота снова: `python bot.py`

## Резервное копирование

Регулярно делайте резервные копии базы данных:

```bash
cp data/tasks.db data/tasks.db.backup
```

Для автоматического резервного копирования можно использовать cron или systemd timer.

